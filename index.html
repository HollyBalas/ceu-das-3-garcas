<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>O Céu das 3 Garças</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;500&display=swap" rel="stylesheet">

<style>

body{
margin:0;
height:100vh;
overflow:hidden;
font-family:'Playfair Display', serif;
background:radial-gradient(circle at center,#0c1c4d,#020611 70%);
color:white;
}

/* estrelas fundo */

.star-bg{
position:absolute;
width:100%;
height:100%;
background-image:radial-gradient(white 1px, transparent 1px);
background-size:4px 4px;
opacity:0.2;
animation: drift 80s linear infinite;
}

@keyframes drift{
from{transform:translateY(0);}
to{transform:translateY(-200px);}
}

/* garças */

.heron{
position:absolute;
width:90px;
opacity:0.9;
animation: float 8s ease-in-out infinite;
}

.center{top:40%;left:50%;transform:translate(-50%,-50%);}
.left{top:50%;left:25%;}
.right{top:50%;right:25%;}

@keyframes float{
50%{transform:translateY(-20px);}
}

.main-text{
position:absolute;
top:10%;
width:100%;
text-align:center;
font-size:24px;
letter-spacing:2px;
color:#ffffffcc;
}

.counter{
position:absolute;
bottom:20px;
right:20px;
font-size:14px;
color:#ffffffaa;
}

/* tela de escolha */

#choiceScreen{
position:absolute;
width:100%;
height:100%;
display:flex;
align-items:center;
justify-content:center;
background:radial-gradient(circle at center,#0c1c4d,#020611 70%);
z-index:10;
flex-direction:column;
}

button{
margin:10px;
padding:10px 20px;
background:transparent;
border:1px solid white;
color:white;
font-family:'Playfair Display', serif;
}

</style>
</head>

<body>

<div class="star-bg"></div>

<div class="main-text">
Alguns nomes não desaparecem. Eles ficam no céu.
</div>

<img class="heron left" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/Heron_silhouette.svg/512px-Heron_silhouette.svg.png">
<img class="heron center" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/Heron_silhouette.svg/512px-Heron_silhouette.svg.png">
<img class="heron right" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3f/Heron_silhouette.svg/512px-Heron_silhouette.svg.png">

<div class="counter">
lugares ocupados: 00002 / 333333
</div>

<div id="choiceScreen">
<div style="margin-bottom:20px;font-size:22px;letter-spacing:2px;">
✦ Qual estrela guia você? ✦
</div>
<button onclick="chooseStar('cap')">Capricórnio</button>
<button onclick="chooseStar('sag')">Sagitário</button>
</div>

<script>

/* ESCOLHA */

function chooseStar(type){

let today = new Date().toDateString();

localStorage.setItem("ceuStar", type);
localStorage.setItem("ceuStarDate", today);

checkUnionEvent(type, today);

document.getElementById("choiceScreen").style.display="none";
reactToStar(type);

}

/* REAÇÃO NORMAL */

function reactToStar(type){

let today = new Date();
let month = today.getMonth();
let day = today.getDate();

let msg = document.createElement("div");

msg.style.position="absolute";
msg.style.top="20%";
msg.style.width="100%";
msg.style.textAlign="center";
msg.style.fontSize="22px";
msg.style.opacity="0";
msg.style.transition="2s";

/* dias sagrados */

if(month === 11 && (day === 2 || day === 12 || day === 26)){

msg.innerText="✦ o céu não escolhe lados hoje ✦";

}else{

if(type === "cap"){
msg.innerText="✦ disciplina constrói o céu ✦";
}

if(type === "sag"){
msg.innerText="✦ quem aponta o horizonte cria caminhos ✦";
}

}

document.body.appendChild(msg);

setTimeout(()=>{
msg.style.opacity="1";
},500);

}

/* UNIÃO */

function checkUnionEvent(type, today){

let otherStar = localStorage.getItem("otherStar");
let otherDate = localStorage.getItem("otherStarDate");

if(otherStar && otherDate === today && otherStar !== type){

triggerUnion();

localStorage.removeItem("otherStar");
localStorage.removeItem("otherStarDate");

}else{

localStorage.setItem("otherStar", type);
localStorage.setItem("otherStarDate", today);

}

}

function triggerUnion(){

let msg = document.createElement("div");

msg.style.position="absolute";
msg.style.top="30%";
msg.style.width="100%";
msg.style.textAlign="center";
msg.style.fontSize="24px";
msg.style.opacity="0";
msg.style.transition="2s";

msg.innerText="✦ quando dois caminhos se encontram, o céu se expande ✦";

document.body.appendChild(msg);

setTimeout(()=>{
msg.style.opacity="1";
},800);

}

/* CONSTELAÇÃO RARA */

let rareTimer;
let moved = false;

function isSacredDay(){

let today = new Date();
let month = today.getMonth();
let day = today.getDate();

return (month === 11 && (day === 2 || day === 12 || day === 26));

}

function alreadySeen(){
return localStorage.getItem("ceuRareSeen") === "true";
}

function markSeen(){
localStorage.setItem("ceuRareSeen","true");
}

function startTimer(){

rareTimer = setTimeout(()=>{

if(!moved && isSacredDay() && !alreadySeen()){

triggerRare();
markSeen();

}

moved = false;

},12000);

}

document.addEventListener("mousemove", ()=>{
moved = true;
clearTimeout(rareTimer);
startTimer();
});

document.addEventListener("touchmove", ()=>{
moved = true;
clearTimeout(rareTimer);
startTimer();
});

function triggerRare(){

let rare = document.createElement("div");

rare.style.position="absolute";
rare.style.top="40%";
rare.style.left="50%";
rare.style.transform="translate(-50%,-50%)";
rare.style.fontSize="22px";
rare.style.letterSpacing="3px";
rare.style.opacity="0";
rare.style.transition="2s";

rare.innerText="✦ 7G-12Δ-CEU ✦";

document.body.appendChild(rare);

setTimeout(()=>{
rare.style.opacity="1";
},200);

setTimeout(()=>{
rare.style.opacity="0";
},12000);

}

startTimer();

/* carregar escolha anterior */

let savedStar = localStorage.getItem("ceuStar");

if(savedStar){

document.getElementById("choiceScreen").style.display="none";
reactToStar(savedStar);

}

</script>

</body>
</html>
