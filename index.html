<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>O Céu dos Nomes</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500&family=Lora:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #020205; /* Azul extremamente escuro/preto */
            --gold: #d4af37;
            --gold-light: #f3e5ab;
            --text-main: rgba(255, 255, 255, 0.9);
            --text-muted: rgba(255, 255, 255, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Lora', serif;
            overflow: hidden; /* Mantém a imersão, sem rolagem */
            user-select: none;
        }

        /* --- BACKGROUND & PARALLAX --- */
        #sky-container {
            position: absolute;
            top: -5%;
            left: -5%;
            width: 110%;
            height: 110%;
            z-index: 1;
            transition: transform 0.1s ease-out; /* Suavidade no parallax */
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }

        /* --- GARÇAS FIXAS --- */
        .herons-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 2;
            pointer-events: none;
        }

        .heron {
            position: absolute;
            display: flex;
            align-items: center;
            gap: 12px;
            opacity: 0.8;
            animation: float 6s ease-in-out infinite alternate;
        }

        .heron svg.bird {
            width: 40px;
            height: auto;
            fill: #ffffff;
            filter: drop-shadow(0 0 8px rgba(255,255,255,0.3));
        }

        .heron-label {
            display: flex;
            align-items: center;
            gap: 6px;
            font-family: 'Cinzel', serif;
            font-size: 0.85rem;
            color: var(--gold-light);
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        .heron-label svg {
            width: 14px;
            height: 14px;
            fill: var(--gold-light);
        }

        /* Posição Triangular das Garças */
        .h1 { top: 20%; left: 25%; animation-delay: 0s; }
        .h2 { top: 35%; left: 70%; animation-delay: -2s; }
        .h3 { top: 60%; left: 15%; animation-delay: -4s; }

        @keyframes float {
            0% { transform: translateY(0px) translateX(0px); }
            100% { transform: translateY(-20px) translateX(10px); }
        }

        /* --- UI PRINCIPAL --- */
        main {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: radial-gradient(circle at center, transparent 0%, rgba(2,2,5,0.7) 100%);
            pointer-events: none; /* Permite clicar no canvas através da main */
        }

        .content-wrapper {
            pointer-events: auto; /* Reativa cliques na área central */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            padding: 40px;
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-weight: 400;
            font-size: 2.2rem;
            line-height: 1.4;
            letter-spacing: 2px;
            color: var(--gold-light);
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
            margin-bottom: 10px;
        }

        .subtext {
            font-size: 1rem;
            font-style: italic;
            color: var(--text-muted);
            letter-spacing: 4px;
            text-transform: lowercase;
        }

        button {
            background: transparent;
            border: 1px solid rgba(212, 175, 55, 0.4);
            color: var(--gold);
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            letter-spacing: 3px;
            padding: 15px 40px;
            cursor: pointer;
            border-radius: 2px;
            transition: all 0.4s ease;
            text-transform: lowercase;
            backdrop-filter: blur(5px);
        }

        button:hover {
            background: rgba(212, 175, 55, 0.1);
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
        }

        .counter {
            position: absolute;
            bottom: 40px;
            font-size: 0.8rem;
            color: var(--text-muted);
            letter-spacing: 2px;
            font-family: 'Cinzel', serif;
        }

        /* --- MODAL DE ACESSO --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(2, 2, 5, 0.85);
            backdrop-filter: blur(10px);
            z-index: 50;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: transparent;
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 50px;
            text-align: center;
            border-radius: 2px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            transform: translateY(20px);
            transition: transform 0.5s ease;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-content h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            color: var(--gold);
            margin-bottom: 30px;
            letter-spacing: 2px;
            font-weight: 400;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }

        input {
            background: transparent;
            border: none;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            color: #fff;
            font-family: 'Lora', serif;
            font-size: 1rem;
            padding: 10px;
            text-align: center;
            outline: none;
            transition: border-color 0.3s;
        }

        input:focus {
            border-bottom-color: var(--gold);
        }

        input::placeholder {
            color: rgba(255,255,255,0.2);
            font-style: italic;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.5rem;
            padding: 0;
            cursor: pointer;
        }

        .close-btn:hover { color: #fff; transform: none; box-shadow: none; background: none;}

        .error-msg {
            color: #d9534f;
            font-size: 0.8rem;
            margin-top: -10px;
            margin-bottom: 10px;
            height: 15px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        /* --- RESPONSIVIDADE --- */
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .h1 { top: 15%; left: 10%; }
            .h2 { top: 25%; left: 50%; }
            .h3 { top: 75%; left: 20%; }
            .modal-content { padding: 40px 20px; }
        }

        /* Ocultar passo 2 inicialmente */
        #step-2 { display: none; }
    </style>
</head>
<body>

    <div id="sky-container">
        <canvas id="sky"></canvas>
    </div>

    <div class="herons-layer">
        <div class="heron h1">
            <svg class="bird" viewBox="0 0 100 100"><path d="M10,50 Q40,20 50,50 Q60,30 90,40 Q65,60 50,65 Q35,60 10,50 Z"/></svg>
            <div class="heron-label">
                <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                junior
            </div>
        </div>
        <div class="heron h2">
            <svg class="bird" viewBox="0 0 100 100"><path d="M10,50 Q40,20 50,50 Q60,30 90,40 Q65,60 50,65 Q35,60 10,50 Z"/></svg>
            <div class="heron-label">
                <svg viewBox="0 0 24 24"><path d="M12 2.163... (mesmo icone)"/><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                holly
            </div>
        </div>
        <div class="heron h3">
            <svg class="bird" viewBox="0 0 100 100"><path d="M10,50 Q40,20 50,50 Q60,30 90,40 Q65,60 50,65 Q35,60 10,50 Z"/></svg>
            <div class="heron-label">
                <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                denise
            </div>
        </div>
    </div>

    <main>
        <div class="content-wrapper">
            <h1>Alguns nomes não desaparecem.<br>Eles ficam no céu.</h1>
            <p class="subtext">disciplina constrói o céu</p>
            <button id="open-modal-btn">entrar no céu</button>
        </div>
        <div class="counter">lugares ocupados: <span id="count-display">0</span> / 333333</div>
    </main>

    <div class="modal-overlay" id="modal">
        <div class="modal-content">
            <button class="close-btn" id="close-modal-btn">&times;</button>
            
            <div id="step-1">
                <h2>O acesso requer virtude.</h2>
                <div class="input-group">
                    <input type="password" id="secret-code" placeholder="insira a palavra secreta..." autocomplete="off">
                </div>
                <div class="error-msg" id="error-step-1"></div>
                <button id="verify-code-btn">validar</button>
            </div>

            <div id="step-2">
                <h2>Eternize um nome.</h2>
                <div class="input-group">
                    <input type="text" id="insta-handle" placeholder="@instagram" autocomplete="off" spellcheck="false">
                </div>
                <div class="error-msg" id="error-step-2"></div>
                <button id="add-star-btn">subir ao céu</button>
            </div>
        </div>
    </div>

    <script>
        /**
         * CONFIGURAÇÕES PRINCIPAIS
         */
        const MAX_STARS = 333333;
        // Códigos secretos válidos para o Anti-Spam (em minúsculas para facilitar validação)
        const VALID_CODES = ['disciplina', 'ceu2026', 'luz', 'aeternum']; 
        
        // Estado da Aplicação
        // Utiliza localStorage para simular "permanência" no client-side sem banco de dados
        let userStars = JSON.parse(localStorage.getItem('sky_stars')) || [];
        
        /**
         * ENGINE DO CÉU (HTML5 CANVAS)
         * Otimizado para renderizar milhares de pontos sem afetar o DOM
         */
        const canvas = document.getElementById('sky');
        const ctx = canvas.getContext('2d');
        let width, height;
        let ambientStars = []; // Estrelas de fundo
        
        let mouseX = -1000;
        let mouseY = -1000;
        let hoveredStar = null;

        function resizeCanvas() {
            width = window.innerWidth * 1.1; // Margem para o parallax
            height = window.innerHeight * 1.1;
            canvas.width = width;
            canvas.height = height;
            initAmbientStars();
            mapUserStarsToCanvas();
        }

        // Cria estrelas genéricas de fundo para dar profundidade
        function initAmbientStars() {
            ambientStars = [];
            const numStars = Math.floor((window.innerWidth * window.innerHeight) / 1000); 
            for (let i = 0; i < numStars; i++) {
                ambientStars.push({
                    x: Math.random() * width,
                    y: Math.random() * height,
                    radius: Math.random() * 1.2,
                    alpha: Math.random(),
                    phase: Math.random() * Math.PI * 2,
                    speed: 0.01 + Math.random() * 0.02
                });
            }
        }

        // Converte os dados salvos em coordenadas da tela
        function mapUserStarsToCanvas() {
            // Recalcula posições baseadas no tamanho atual da tela para manter distribuição
            userStars.forEach(star => {
                if(!star.renderX) {
                    star.renderX = Math.random() * width;
                    star.renderY = Math.random() * height;
                    star.phase = Math.random() * Math.PI * 2;
                }
            });
            updateCounter();
        }

        function drawSky() {
            ctx.clearRect(0, 0, width, height);

            // 1. Desenhar estrelas de ambiente (fundo)
            ctx.fillStyle = 'white';
            ambientStars.forEach(star => {
                star.phase += star.speed;
                const currentAlpha = Math.abs(Math.sin(star.phase)) * star.alpha;
                ctx.globalAlpha = currentAlpha * 0.5;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fill();
            });

            // 2. Desenhar estrelas de usuários (brilho dourado)
            hoveredStar = null;
            userStars.forEach(star => {
                star.phase += 0.02;
                const pulse = 0.5 + Math.abs(Math.sin(star.phase)) * 0.5;
                
                // Checagem de proximidade do mouse (Hover interativo)
                // Ajuste de offset do parallax para garantir alinhamento exato
                const dx = star.renderX - (mouseX + parallaxOffsetX);
                const dy = star.renderY - (mouseY + parallaxOffsetY);
                const distance = Math.sqrt(dx*dx + dy*dy);

                if (distance < 30) {
                    hoveredStar = star;
                    ctx.globalAlpha = 1;
                    ctx.fillStyle = '#fff';
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = '#d4af37';
                } else {
                    ctx.globalAlpha = pulse;
                    ctx.fillStyle = '#f3e5ab';
                    ctx.shadowBlur = 5;
                    ctx.shadowColor = '#d4af37';
                }

                ctx.beginPath();
                ctx.arc(star.renderX, star.renderY, 2, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0; // Reset
            });

            // 3. Renderizar o nome se estiver com hover
            if (hoveredStar) {
                ctx.globalAlpha = 1;
                ctx.fillStyle = '#d4af37';
                ctx.font = 'italic 16px Lora';
                ctx.textAlign = 'center';
                ctx.fillText(hoveredStar.name, hoveredStar.renderX, hoveredStar.renderY - 15);
            }

            requestAnimationFrame(drawSky);
        }

        /**
         * EFEITO PARALLAX
         */
        const skyContainer = document.getElementById('sky-container');
        let parallaxOffsetX = 0;
        let parallaxOffsetY = 0;

        window.addEventListener('mousemove', (e) => {
            // Atualiza posição do mouse para o hover no canvas
            mouseX = e.clientX;
            mouseY = e.clientY;

            // Calcula o parallax (movimento sutil inverso ao mouse)
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            
            // Limitamos o movimento a poucos pixels para manter elegância
            parallaxOffsetX = ((e.clientX - centerX) / window.innerWidth) * 30; 
            parallaxOffsetY = ((e.clientY - centerY) / window.innerHeight) * 30;

            skyContainer.style.transform = `translate(${-parallaxOffsetX}px, ${-parallaxOffsetY}px)`;
        });

        // Suporte Mobile para descobrir nomes (Toque em vez de hover)
        window.addEventListener('touchstart', (e) => {
            mouseX = e.touches[0].clientX;
            mouseY = e.touches[0].clientY;
            // Zera o parallax no touch para o clique funcionar exato
            parallaxOffsetX = 0; 
            parallaxOffsetY = 0;
            skyContainer.style.transform = `translate(0px, 0px)`;
        });


        /**
         * LÓGICA DA INTERFACE E VALIDAÇÕES (ANTI-SPAM)
         */
        const modal = document.getElementById('modal');
        const openModalBtn = document.getElementById('open-modal-btn');
        const closeModalBtn = document.getElementById('close-modal-btn');
        
        const step1 = document.getElementById('step-1');
        const step2 = document.getElementById('step-2');
        const verifyBtn = document.getElementById('verify-code-btn');
        const addStarBtn = document.getElementById('add-star-btn');
        
        const error1 = document.getElementById('error-step-1');
        const error2 = document.getElementById('error-step-2');

        function showError(element, msg) {
            element.textContent = msg;
            element.style.opacity = 1;
            setTimeout(() => { element.style.opacity = 0; }, 3000);
        }

        function updateCounter() {
            document.getElementById('count-display').textContent = userStars.length;
        }

        // Abrir/Fechar Modal
        openModalBtn.addEventListener('click', () => {
            if (userStars.length >= MAX_STARS) {
                alert("O céu está completo. Nenhum novo nome pode ser adicionado.");
                return;
            }
            modal.classList.add('active');
            step1.style.display = 'block';
            step2.style.display = 'none';
            document.getElementById('secret-code').value = '';
            document.getElementById('insta-handle').value = '';
        });

        closeModalBtn.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        // Passo 1: Validar Código
        verifyBtn.addEventListener('click', () => {
            const code = document.getElementById('secret-code').value.trim().toLowerCase();
            if (VALID_CODES.includes(code)) {
                step1.style.display = 'none';
                step2.style.display = 'block';
            } else {
                showError(error1, "Código inválido. A disciplina faltou.");
            }
        });

        // Passo 2: Adicionar Nome
        addStarBtn.addEventListener('click', () => {
            let name = document.getElementById('insta-handle').value.trim().toLowerCase();
            
            if (!name) {
                showError(error2, "O nome não pode estar vazio.");
                return;
            }

            // Normaliza com @
            if (!name.startsWith('@')) name = '@' + name;

            // Validação de Duplicidade
            const isDuplicate = userStars.some(s => s.name.toLowerCase() === name);
            if (isDuplicate) {
                showError(error2, "Este nome já brilha no céu.");
                return;
            }

            // Adiciona a estrela
            const newStar = {
                name: name,
                renderX: Math.random() * width,
                renderY: Math.random() * height,
                phase: Math.random() * Math.PI * 2
            };

            userStars.push(newStar);
            localStorage.setItem('sky_stars', JSON.stringify(userStars));
            
            updateCounter();
            modal.classList.remove('active');
            
            // Simula uma notificação visual leve no botão
            openModalBtn.textContent = "estrela adicionada";
            setTimeout(() => { openModalBtn.textContent = "entrar no céu"; }, 3000);
        });

        /**
         * INICIALIZAÇÃO
         */
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        drawSky();

    </script>
</body>
</html>
